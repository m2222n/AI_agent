# ETF 질의응답 챗봇 - 2주차 프로토타입

LLM 기반 ETF 질의응답 시스템 프로토타입입니다.

## 프로젝트 개요

- **목적**: ETF 투자 정보를 자연어로 검색하고 답변받을 수 있는 AI 챗봇
- **기술 스택**: LangChain + Chroma (Vector DB) + OpenAI GPT-4o + Streamlit
- **데이터**: 8개 ETF 상품 정보 (국내/해외 주식형, 채권형, 테마형 등)

## 주요 기능

### 1. RAG (Retrieval-Augmented Generation) 파이프라인
- Chroma 벡터 DB를 활용한 의미 기반 검색
- OpenAI Embeddings로 문서 임베딩
- 유사도 기반 관련 ETF 정보 검색

### 2. 멘토 피드백 반영사항
| 피드백 항목 | 구현 내용 |
|-------------|-----------|
| 세션 기반 대화 기록 | `st.session_state`로 대화 히스토리 관리 |
| 스트리밍 응답 | OpenAI streaming API로 실시간 답변 표시 |
| API 예외 처리 | RateLimitError, APIConnectionError 등 처리 |
| 인라인 출처 표시 | `[ETF-001]` 형식으로 답변 내 출처 명시 |
| 사용자 피드백 수집 | 👍/👎 버튼으로 피드백 로깅 |
| Edge Case 처리 | 검색 결과 없을 때 명시적 안내 |

### 3. UI 기능
- 예시 질문 버튼
- ETF 목록 사이드바
- 대화 초기화
- 검색된 ETF 정보 표시

## 설치 및 실행

### 1. 환경 설정
```bash
cd 2week_etf_chatbot

# 가상환경 생성 (선택)
python -m venv venv
source venv/bin/activate  # macOS/Linux
# venv\Scripts\activate  # Windows

# 패키지 설치
pip install -r requirements.txt
```

### 2. API 키 설정
```bash
export OPENAI_API_KEY="your-openai-api-key"
```

### 3. 실행
```bash
streamlit run app.py
```

브라우저에서 `http://localhost:8501` 접속

## 프로젝트 구조

```
2week_etf_chatbot/
├── app.py              # 메인 애플리케이션
├── requirements.txt    # 의존성 패키지
├── README.md           # 프로젝트 설명
├── data/
│   └── etf_data.json   # ETF 샘플 데이터
└── logs/
    ├── chat_log.jsonl      # 질의응답 로그
    └── feedback_log.jsonl  # 사용자 피드백 로그
```

## 아키텍처

```
┌─────────────────────────────────────────────────────────────┐
│                    Streamlit UI                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │  사용자 입력   │  │  대화 히스토리  │  │   피드백 수집   │       │
│  └──────────────┘  └──────────────┘  └──────────────┘       │
└───────────────────────────┬─────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│                   RAG Pipeline                               │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │   Retriever   │→│   Context    │→│   LLM Agent   │       │
│  │ (Chroma DB)   │  │  Builder     │  │  (GPT-4o)    │       │
│  └──────────────┘  └──────────────┘  └──────────────┘       │
└───────────────────────────┬─────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│                   Data Layer                                 │
│  ┌──────────────┐  ┌──────────────┐                         │
│  │  ETF Data     │  │   Logs       │                         │
│  │  (JSON)       │  │  (JSONL)     │                         │
│  └──────────────┘  └──────────────┘                         │
└─────────────────────────────────────────────────────────────┘
```

## 지원 ETF 목록

| ID | 상품명 | 카테고리 | 위험등급 |
|----|--------|----------|----------|
| ETF-001 | KODEX 200 | 국내 주식형 | 2등급 |
| ETF-002 | TIGER 미국S&P500 | 해외 주식형 | 2등급 |
| ETF-003 | KODEX 2차전지산업 | 섹터/테마형 | 1등급 |
| ETF-004 | KODEX 단기채권 | 채권형 | 5등급 |
| ETF-005 | TIGER 미국나스닥100 | 해외 주식형 | 2등급 |
| ETF-006 | KODEX 고배당 | 배당형 | 3등급 |
| ETF-007 | KODEX 인버스 | 인버스형 | 1등급 |
| ETF-008 | TIGER 차이나전기차 | 해외 섹터/테마형 | 1등급 |

## 3주차 확장 계획

- [ ] Vector DB 영구 저장 (현재는 메모리)
- [ ] 실제 ETF API 연동 (한국투자증권, KRX)
- [ ] 클라우드 배포 (Streamlit Cloud 또는 GCP Cloud Run)
- [ ] 모니터링 대시보드 추가
- [ ] PDF 문서 업로드 기능

## 한계점

1. **데이터 한계**: 8개 ETF 샘플 데이터만 포함
2. **실시간 데이터 없음**: 가격/수익률 등 실시간 정보 미반영
3. **벡터 DB 휘발성**: 앱 재시작 시 임베딩 재생성 필요

## 참고

- 본 서비스는 정보 제공 목적이며, 투자 권유가 아닙니다.
- 투자 결정은 본인의 판단과 책임 하에 이루어져야 합니다.
